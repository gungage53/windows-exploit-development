#!/usr/bin/python2 -V
# coding: Shift_JIS
import sys
import os

if len(sys.argv) == 0:
	print("binary file not found")
	exit


buf1 = []
buf2 = []
buf3 = []
f = open(sys.argv[1], "rb")
for b in f.read():
	s = hex(ord(b)).replace("0x","").zfill(2)
	buf1.append(s)
	buf2.append("\\x" + s)
	buf3.append(b)
f.close()

print("size = {0}".format(len(buf1)))
print("---------------------------------------------------------")
print(" ".join(buf1))
print("---------------------------------------------------------")
print("".join(buf2))
print("---------------------------------------------------------")
l = ""
for i in range(0, len(buf2)):
	l += buf2[i]
	if i > 0 and (i+1) % 16 == 0:
		print("shellcode += \"{0}\"".format(l))
		l = ""
if l != "":
	print("shellcode += \"{0}\"".format(l))
print("---------------------------------------------------------")

#os.system("ndisasm -b32 " + sys.argv[1]);
print("".join(buf3))
print("---------------------------------------------------------")
